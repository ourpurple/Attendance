<!-- pages/leave/apply/apply.wxml -->
<view class="container">
  <view class="form-group">
    <view class="form-label">开始日期 *</view>
    <picker mode="date" value="{{startDate}}" bindchange="onStartDateChange">
      <view class="picker">
        <text>{{startDate || '请选择开始日期'}}</text>
        <text class="picker-icon">📅</text>
      </view>
    </picker>
  </view>

  <view class="form-group">
    <view class="form-label">开始时间节点 *</view>
    <picker 
      mode="selector" 
      range="{{startTimeNodes}}"
      range-key="label"
      value="{{startTimeNodeIndex}}"
      bindchange="onStartTimeNodeChange"
    >
      <view class="picker">
        <text>{{startTimeNodes[startTimeNodeIndex].label || '请选择开始时间节点'}}</text>
        <text class="picker-icon">🕐</text>
      </view>
    </picker>
  </view>

  <view class="form-group">
    <view class="form-label">结束日期 *</view>
    <picker mode="date" value="{{endDate}}" bindchange="onEndDateChange">
      <view class="picker">
        <text>{{endDate || '请选择结束日期'}}</text>
        <text class="picker-icon">📅</text>
      </view>
    </picker>
  </view>

  <view class="form-group">
    <view class="form-label">结束时间节点 *</view>
    <picker 
      mode="selector" 
      range="{{endTimeNodes}}"
      range-key="label"
      value="{{endTimeNodeIndex}}"
      bindchange="onEndTimeNodeChange"
    >
      <view class="picker">
        <text>{{endTimeNodes[endTimeNodeIndex].label || '请选择结束时间节点'}}</text>
        <text class="picker-icon">🕐</text>
      </view>
    </picker>
  </view>

  <view class="form-group">
    <view class="form-label">计算出的请假天数</view>
    <view class="form-display">{{calculatedDays}} 天</view>
    <view class="form-hint">系统根据日期和时间节点自动计算</view>
  </view>

  <view class="form-group">
    <view class="form-label">请假原因 *</view>
    <textarea 
      class="form-input textarea" 
      value="{{reason}}" 
      bindinput="onReasonInput"
      placeholder="请输入请假原因"
      maxlength="500"
    />
  </view>

  <view class="form-group" wx:if="{{showVpSelector}}">
    <view class="form-label">指定副总审批人（可选）</view>
    <picker 
      mode="selector" 
      range="{{vpOptions}}" 
      range-key="name"
      value="{{vpIndex}}"
      bindchange="onVpChange"
    >
      <view class="picker">
        <text>{{vpOptions[vpIndex] && vpOptions[vpIndex].name ? vpOptions[vpIndex].name : '系统自动分配'}}</text>
        <text class="picker-icon">▼</text>
      </view>
    </picker>
    <view class="form-hint">留空则系统自动分配</view>
  </view>

  <view class="form-group" wx:if="{{showGmSelector}}">
    <view class="form-label">指定总经理审批人（可选）</view>
    <picker 
      mode="selector" 
      range="{{gmOptions}}" 
      range-key="name"
      value="{{gmIndex}}"
      bindchange="onGmChange"
    >
      <view class="picker">
        <text>{{gmOptions[gmIndex] && gmOptions[gmIndex].name ? gmOptions[gmIndex].name : '系统自动分配'}}</text>
        <text class="picker-icon">▼</text>
      </view>
    </picker>
    <view class="form-hint">留空则系统自动分配</view>
  </view>

  <button class="btn btn-primary btn-block" bindtap="submitForm">提交申请</button>
</view>

