<!-- pages/leave/apply/apply.wxml -->
<view class="container">
  <view class="form-group">
    <view class="form-label">è¯·å‡ç±»å‹ *</view>
    <picker 
      mode="selector" 
      range="{{leaveTypes}}" 
      range-key="name"
      value="{{leaveTypeIndex}}"
      bindchange="onLeaveTypeChange"
    >
      <view class="picker">
        <text>{{leaveTypes[leaveTypeIndex] && leaveTypes[leaveTypeIndex].name ? leaveTypes[leaveTypeIndex].name : 'è¯·é€‰æ‹©è¯·å‡ç±»å‹'}}</text>
        <text class="picker-icon">â–¼</text>
      </view>
    </picker>
  </view>

  <view class="annual-leave-info" wx:if="{{showAnnualLeaveInfo && annualLeaveInfo}}">
    <text>æ‚¨æœ¬å¹´åº¦å¹´å‡å…±è®¡{{annualLeaveInfo.total_days}}å¤©ï¼Œå·²è°ƒä¼‘{{annualLeaveInfo.used_days}}å¤©ï¼Œå‰©ä½™{{annualLeaveInfo.remaining_days}}å¤©</text>
  </view>
  <view class="form-row">
    <view class="form-group form-group-date">
      <view class="form-label">å¼€å§‹æ—¥æœŸ *</view>
      <picker mode="date" value="{{startDate}}" bindchange="onStartDateChange">
        <view class="picker">
          <text>{{startDate || 'è¯·é€‰æ‹©å¼€å§‹æ—¥æœŸ'}}</text>
          <text class="picker-icon">ğŸ“…</text>
        </view>
      </picker>
    </view>

    <view class="form-group form-group-time">
      <view class="form-label">æ—¶é—´ *</view>
      <picker 
        mode="selector" 
        range="{{startTimeNodes}}"
        range-key="label"
        value="{{startTimeNodeIndex}}"
        bindchange="onStartTimeNodeChange"
      >
        <view class="picker">
          <text>{{startTimeNodes[startTimeNodeIndex].label || 'è¯·é€‰æ‹©æ—¶é—´'}}</text>
          <text class="picker-icon">ğŸ•</text>
        </view>
      </picker>
    </view>
  </view>

  <view class="form-row">
    <view class="form-group form-group-date">
      <view class="form-label">ç»“æŸæ—¥æœŸ *</view>
      <picker mode="date" value="{{endDate}}" bindchange="onEndDateChange">
        <view class="picker">
          <text>{{endDate || 'è¯·é€‰æ‹©ç»“æŸæ—¥æœŸ'}}</text>
          <text class="picker-icon">ğŸ“…</text>
        </view>
      </picker>
    </view>

    <view class="form-group form-group-time">
      <view class="form-label">æ—¶é—´ *</view>
      <picker 
        mode="selector" 
        range="{{endTimeNodes}}"
        range-key="label"
        value="{{endTimeNodeIndex}}"
        bindchange="onEndTimeNodeChange"
      >
        <view class="picker">
          <text>{{endTimeNodes[endTimeNodeIndex].label || 'è¯·é€‰æ‹©æ—¶é—´'}}</text>
          <text class="picker-icon">ğŸ•</text>
        </view>
      </picker>
    </view>
  </view>

  <view class="form-group">
    <view class="form-label">è®¡ç®—å‡ºçš„è¯·å‡å¤©æ•°</view>
    <view class="form-display">{{calculatedDays}} å¤©</view>
    <view class="form-hint">ç³»ç»Ÿæ ¹æ®æ—¥æœŸå’Œæ—¶é—´èŠ‚ç‚¹è‡ªåŠ¨è®¡ç®—</view>
  </view>

  <view class="form-group">
    <view class="form-label">è¯·å‡åŸå›  *</view>
    <textarea 
      class="form-input textarea" 
      value="{{reason}}" 
      bindinput="onReasonInput"
      placeholder="è¯·è¾“å…¥è¯·å‡åŸå› "
      maxlength="500"
    />
  </view>

  <view class="form-group" wx:if="{{showVpSelector}}">
    <view class="form-label">æŒ‡å®šå‰¯æ€»å®¡æ‰¹äººï¼ˆå¯é€‰ï¼‰</view>
    <picker 
      mode="selector" 
      range="{{vpOptions}}" 
      range-key="name"
      value="{{vpIndex}}"
      bindchange="onVpChange"
    >
      <view class="picker">
        <text>{{vpOptions[vpIndex] && vpOptions[vpIndex].name ? vpOptions[vpIndex].name : 'ç³»ç»Ÿè‡ªåŠ¨åˆ†é…'}}</text>
        <text class="picker-icon">â–¼</text>
      </view>
    </picker>
    <view class="form-hint">ç•™ç©ºåˆ™ç³»ç»Ÿè‡ªåŠ¨åˆ†é…</view>
  </view>

  <view class="form-group" wx:if="{{showGmSelector}}">
    <view class="form-label">æŒ‡å®šæ€»ç»ç†å®¡æ‰¹äººï¼ˆå¯é€‰ï¼‰</view>
    <picker 
      mode="selector" 
      range="{{gmOptions}}" 
      range-key="name"
      value="{{gmIndex}}"
      bindchange="onGmChange"
    >
      <view class="picker">
        <text>{{gmOptions[gmIndex] && gmOptions[gmIndex].name ? gmOptions[gmIndex].name : 'ç³»ç»Ÿè‡ªåŠ¨åˆ†é…'}}</text>
        <text class="picker-icon">â–¼</text>
      </view>
    </picker>
    <view class="form-hint">ç•™ç©ºåˆ™ç³»ç»Ÿè‡ªåŠ¨åˆ†é…</view>
  </view>

  <button class="btn btn-primary btn-block" bindtap="submitForm">æäº¤ç”³è¯·</button>
</view>

