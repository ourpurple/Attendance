<!-- pages/index/index.wxml -->
<view class="container">
  <!-- æ‰“å¡å¡ç‰‡ -->
  <view class="card clock-card">
    <view class="clock-time">{{currentTime}}</view>
    <view class="clock-date">{{currentDate}}</view>
    
    <view class="clock-status" wx:if="{{showClockStatus && attendanceEnabled}}">
      <view class="status-item">
        <text class="status-label">ä¸Šç­</text>
        <text class="status-value">{{checkinStatus}}</text>
      </view>
      <view class="status-item">
        <text class="status-label">ä¸‹ç­</text>
        <text class="status-value">{{checkoutStatus}}</text>
      </view>
    </view>

    <view class="clock-actions" wx:if="{{attendanceEnabled}}">
      <button class="btn btn-primary" bindtap="checkin" disabled="{{checkinDisabled}}">
        <text>ğŸ“</text>
        <text>ä¸Šç­æ‰“å¡</text>
      </button>
      <button class="btn btn-success" bindtap="checkout" disabled="{{checkoutDisabled}}">
        <text>ğŸ“</text>
        <text>ä¸‹ç­æ‰“å¡</text>
      </button>
    </view>

    <!-- æ‰“å¡çŠ¶æ€é€‰æ‹©å™¨ -->
    <view class="checkin-status-selector" wx:if="{{showStatusSelector && attendanceEnabled}}">
      <text class="status-label">æ‰“å¡çŠ¶æ€ï¼š</text>
      <radio-group class="radio-group" bindchange="onStatusChange">
        <label class="radio-item {{index === checkinStatusIndex ? 'checked' : ''}}" wx:for="{{checkinStatusList}}" wx:key="code">
          <radio value="{{index}}" checked="{{index === checkinStatusIndex}}" color="#007AFF"/>
          <text>{{item.name}}</text>
        </label>
      </radio-group>
    </view>

    <view class="clock-location" wx:if="{{location}}" style="color: {{locationColor}}">{{location}}</view>
  </view>

  <!-- å¿«æ·åŠŸèƒ½ -->
  <view class="quick-actions">
    <view class="quick-action-item" wx:if="{{hasOverviewPermission}}" bindtap="goToOverview">
      <view class="action-icon">ğŸ‘¥</view>
      <view class="action-label">å‡ºå‹¤æƒ…å†µ</view>
    </view>
    <view class="quick-action-item" bindtap="goToLeave">
      <view class="action-icon">
        <text>ğŸ–ï¸</text>
        <text class="badge" wx:if="{{leavePendingCount > 0}}">{{leavePendingCount}}</text>
      </view>
      <view class="action-label">è¯·å‡ç”³è¯·</view>
    </view>
    <view class="quick-action-item" bindtap="goToOvertime">
      <view class="action-icon">
        <text>â°</text>
        <text class="badge" wx:if="{{overtimePendingCount > 0}}">{{overtimePendingCount}}</text>
      </view>
      <view class="action-label">åŠ ç­ç”³è¯·</view>
    </view>
    <view class="quick-action-item approval-only" bindtap="goToApproval" wx:if="{{hasApprovalPermission}}">
      <view class="action-icon">
        <text>âœ…</text>
        <text class="badge" wx:if="{{pendingCount > 0}}">{{pendingCount}}</text>
      </view>
      <view class="action-label">æˆ‘çš„å®¡æ‰¹</view>
    </view>
    <view class="quick-action-item" bindtap="goToStats">
      <view class="action-icon">ğŸ“Š</view>
      <view class="action-label">æˆ‘çš„ç»Ÿè®¡</view>
    </view>
  </view>

  <!-- æœ€è¿‘è€ƒå‹¤ -->
  <view class="card">
    <view class="card-header">
      <text class="card-title">æœ€è¿‘è€ƒå‹¤</text>
      <text class="card-link" bindtap="goToAttendance">æŸ¥çœ‹æ›´å¤š</text>
    </view>

    <view class="attendance-list" wx:if="{{recentAttendance && recentAttendance.length > 0}}">
      <view class="attendance-item" wx:for="{{recentAttendance}}" wx:key="id">
        <view class="attendance-date">
          <view class="attendance-day">{{item.day}}</view>
          <view class="attendance-month">{{item.month}}æœˆ</view>
        </view>
        <view class="attendance-info">
          <view class="attendance-time">
            <text>ä¸Šç­: {{item.checkinTime || '-'}}</text>
            <view class="checkin-status-badge {{item.checkinStatusClass}}" wx:if="{{item.checkinStatusText}}">{{item.checkinStatusText}}</view>
            <text class="status-badge status-warning" wx:if="{{item.isLate}}">è¿Ÿåˆ°</text>
          </view>
          <view class="attendance-location" wx:if="{{item.checkinLocation}}">
            <text class="location-text">ğŸ“ {{item.checkinLocation}}</text>
          </view>
          <view class="attendance-time">
            <text>ä¸‹ç­: {{item.checkoutTime || '-'}}</text>
            <text class="status-badge status-warning" wx:if="{{item.isEarlyLeave}}">æ—©é€€</text>
          </view>
          <view class="attendance-location" wx:if="{{item.checkoutLocation}}">
            <text class="location-text">ğŸ“ {{item.checkoutLocation}}</text>
          </view>
        </view>
      </view>
    </view>

    <view class="empty-state" wx:else>
      <view class="empty-state-icon">ğŸ“</view>
      <view class="empty-state-text">æš‚æ— è€ƒå‹¤è®°å½•</view>
    </view>
  </view>
  
  <!-- ç‰ˆæƒä¿¡æ¯ -->
  <view class="app-footer">
    <text>Â© 2025 æ²³å—æ–°ç›Ÿç§‘æ•™æœ‰é™å…¬å¸ All Rights Reserved</text>
  </view>
</view>



