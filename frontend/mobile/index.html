<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>è€ƒå‹¤ç³»ç»Ÿ | æ–°ç›Ÿç§‘æ•™</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <!-- ç™»å½•é¡µé¢ -->
        <div id="login-page" class="page active">
            <div class="login-container">
                <div class="login-header">
                    <h1>è€ƒå‹¤ç³»ç»Ÿ</h1>
                    <p class="company-name">æ²³å—æ–°ç›Ÿç§‘æ•™æœ‰é™å…¬å¸</p>
                </div>
                <form id="login-form" class="login-form">
                    <!-- éšè—çš„è¾“å…¥æ¡†ï¼Œç”¨äºé˜²æ­¢iOSè¯¯åˆ¤ç”¨æˆ·åè¾“å…¥æ¡†ä¸ºå¯†ç  -->
                    <input type="text" style="position: absolute; left: -9999px; opacity: 0; pointer-events: none; tabindex: -1;" autocomplete="off" aria-hidden="true">
                    <div class="form-group">
                        <input 
                            type="text" 
                            id="username" 
                            name="username"
                            placeholder="ç”¨æˆ·å" 
                            required 
                            inputmode="text"
                            autocapitalize="none"
                            autocorrect="off"
                            spellcheck="false"
                            autocomplete="off"
                        >
                    </div>
                    <div class="form-group">
                        <input 
                            type="password" 
                            id="password" 
                            name="password"
                            placeholder="å¯†ç " 
                            required 
                            autocomplete="current-password"
                        >
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">ç™»å½•</button>
                    <div id="login-error" class="error-message"></div>
                </form>
            </div>
        </div>

        <!-- ä¸»é¡µé¢ -->
        <div id="main-page" class="page">
            <!-- å¤´éƒ¨ -->
            <header class="app-header">
                <div class="header-content">
                    <h1 class="header-title">è€ƒå‹¤ç³»ç»Ÿ <span class="company-short">æ–°ç›Ÿç§‘æ•™</span></h1>
                    <div class="user-avatar" onclick="toggleUserMenu()">
                        <span id="user-initial"></span>
                    </div>
                </div>
                <div id="user-menu" class="user-menu">
                    <div class="user-menu-header">
                        <div class="user-name" id="header-user-name"></div>
                        <div class="user-role" id="header-user-role"></div>
                    </div>
                    <button class="menu-item" onclick="showChangePasswordModal()">
                        <span>ğŸ”’</span>
                        <span>ä¿®æ”¹å¯†ç </span>
                    </button>
                    <button class="menu-item" onclick="logout()">
                        <span>ğŸšª</span>
                        <span>é€€å‡ºç™»å½•</span>
                    </button>
                </div>
            </header>

            <!-- ä¸»å†…å®¹ -->
            <main class="main-content">
                <!-- é¦–é¡µ -->
                <div id="home-content" class="content-section active">
                    <!-- æ‰“å¡å¡ç‰‡ -->
                    <div class="card clock-card">
                        <div class="clock-time" id="current-time">00:00:00</div>
                        <div class="clock-date" id="current-date"></div>
                        <div class="clock-status" id="clock-status">
                            <div class="status-item">
                                <span>ä¸Šç­</span>
                                <span id="checkin-status">æœªæ‰“å¡</span>
                            </div>
                            <div class="status-item">
                                <span>ä¸‹ç­</span>
                                <span id="checkout-status">æœªæ‰“å¡</span>
                            </div>
                        </div>
                        <div class="clock-actions" id="clock-actions">
                            <button id="checkin-btn" class="btn btn-primary btn-large" onclick="checkin()">
                                <span>ğŸ“</span>
                                <span>ä¸Šç­æ‰“å¡</span>
                            </button>
                            <button id="checkout-btn" class="btn btn-success btn-large" onclick="checkout()">
                                <span>ğŸ“</span>
                                <span>ä¸‹ç­æ‰“å¡</span>
                            </button>
                        </div>
                        <div id="checkin-status-selector" class="checkin-status-selector" style="display: none; margin-top: 10px;">
                            <style>
                                .checkin-status-selector {
                                    display: flex;
                                    align-items: center;
                                    gap: 12px;
                                }
                                .checkin-status-selector > label {
                                    font-weight: 500;
                                    color: var(--text-secondary);
                                    white-space: nowrap;
                                    flex-shrink: 0;
                                }
                                .checkin-radio-group {
                                    display: flex;
                                    gap: 8px;
                                    flex: 1;
                                }
                                .checkin-radio-item {
                                    flex: 1;
                                    min-width: 70px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    padding: 10px 8px;
                                    background: var(--bg-secondary);
                                    border: 2px solid var(--border-color);
                                    border-radius: 8px;
                                    cursor: pointer;
                                    transition: all 0.2s;
                                    font-size: 11px;
                                }
                                .checkin-radio-item:active {
                                    transform: scale(0.98);
                                }
                                .checkin-radio-item input[type="radio"] {
                                    display: none;
                                }
                                .checkin-radio-item:has(input[type="radio"]:checked) {
                                    background: var(--primary-color);
                                    border-color: var(--primary-color);
                                }
                                .checkin-radio-item:has(input[type="radio"]:checked) span {
                                    color: white;
                                    font-weight: 600;
                                }
                                .checkin-radio-item span {
                                    flex: 1;
                                    text-align: center;
                                }
                            </style>
                            <label>æ‰“å¡çŠ¶æ€ï¼š</label>
                            <div class="checkin-radio-group">
                                <label class="checkin-radio-item">
                                    <input type="radio" name="checkin-status" value="normal" checked>
                                    <span>æ­£å¸¸æ‰“å¡</span>
                                </label>
                                <label class="checkin-radio-item">
                                    <input type="radio" name="checkin-status" value="city_business">
                                    <span>å¸‚åŒºåŠäº‹</span>
                                </label>
                                <label class="checkin-radio-item">
                                    <input type="radio" name="checkin-status" value="business_trip">
                                    <span>å‡ºå·®</span>
                                </label>
                            </div>
                        </div>
                        <div id="clock-location" class="clock-location"></div>
                    </div>

                    <!-- å¿«æ·åŠŸèƒ½ -->
                    <div class="quick-actions">
                        <div class="quick-action-item attendance-overview-only" onclick="showSection('attendance-overview')" style="display: none;">
                            <div class="action-icon">ğŸ‘¥</div>
                            <div class="action-label">å‡ºå‹¤æƒ…å†µ</div>
                        </div>
                        <div class="quick-action-item" onclick="showSection('leave')">
                            <div class="action-icon">
                                <span>ğŸ–ï¸</span>
                                <span id="leave-pending-count" class="badge" style="display: none;">0</span>
                            </div>
                            <div class="action-label">è¯·å‡ç”³è¯·</div>
                        </div>
                        <div class="quick-action-item" onclick="showSection('overtime')">
                            <div class="action-icon">
                                <span>â°</span>
                                <span id="overtime-pending-count" class="badge" style="display: none;">0</span>
                            </div>
                            <div class="action-label">åŠ ç­ç”³è¯·</div>
                        </div>
                        <div class="quick-action-item approval-only" onclick="showSection('approval')" style="display: none;">
                            <div class="action-icon">
                                <span>âœ…</span>
                                <span id="pending-count" class="badge" style="display: none;">0</span>
                            </div>
                            <div class="action-label">æˆ‘çš„å®¡æ‰¹</div>
                        </div>
                        <div class="quick-action-item" onclick="showSection('stats')">
                            <div class="action-icon">ğŸ“Š</div>
                            <div class="action-label">æˆ‘çš„ç»Ÿè®¡</div>
                        </div>
                    </div>

                    <!-- æœ€è¿‘è®°å½• -->
                    <div class="card">
                        <div class="card-header">
                            <h3>æœ€è¿‘è€ƒå‹¤</h3>
                            <a href="#" onclick="showSection('attendance')">æŸ¥çœ‹æ›´å¤š</a>
                        </div>
                        <div id="recent-attendance" class="attendance-list"></div>
                    </div>
                </div>

                <!-- è€ƒå‹¤è®°å½• -->
                <div id="attendance-content" class="content-section">
                    <div class="section-header">
                        <button class="back-btn" onclick="showSection('home')">â† è¿”å›</button>
                        <h2>è€ƒå‹¤è®°å½•</h2>
                    </div>
                    <div class="date-filter">
                        <input type="month" id="attendance-month" onchange="loadAttendanceByMonth()">
                    </div>
                    <div id="attendance-list" class="list-container"></div>
                </div>

                <!-- å‡ºå‹¤æƒ…å†µ -->
                <div id="attendance-overview-content" class="content-section">
                    <div class="section-header">
                        <button class="back-btn" onclick="showSection('home')">â† è¿”å›</button>
                        <h2>å‡ºå‹¤æƒ…å†µ</h2>
                    </div>
                    <div class="date-filter">
                        <input type="date" id="overview-date" onchange="loadAttendanceOverview()">
                    </div>
                    <div class="overview-info" id="overview-info" style="display: none;">
                        <span class="workday-badge workday" id="overview-workday-badge">å·¥ä½œæ—¥</span>
                        <span class="workday-text" id="overview-workday-text"></span>
                    </div>
                    <div class="overview-categories" id="overview-categories"></div>
                </div>

                <!-- è¯·å‡ç”³è¯· -->
                <div id="leave-content" class="content-section">
                    <div class="section-header">
                        <button class="back-btn" onclick="showSection('home')">â† è¿”å›</button>
                        <h2>è¯·å‡ç®¡ç†</h2>
                    </div>
                    <button class="btn btn-primary btn-block" onclick="showNewLeaveForm()">ç”³è¯·è¯·å‡</button>
                    <div id="leave-list" class="list-container"></div>
                </div>

                <!-- åŠ ç­ç”³è¯· -->
                <div id="overtime-content" class="content-section">
                    <div class="section-header">
                        <button class="back-btn" onclick="showSection('home')">â† è¿”å›</button>
                        <h2>åŠ ç­ç®¡ç†</h2>
                    </div>
                    <button class="btn btn-primary btn-block" onclick="showNewOvertimeForm()">ç”³è¯·åŠ ç­</button>
                    <div id="overtime-list" class="list-container"></div>
                </div>

                <!-- å®¡æ‰¹ç®¡ç† -->
                <div id="approval-content" class="content-section">
                    <div class="section-header">
                        <button class="back-btn" onclick="showSection('home')">â† è¿”å›</button>
                        <h2>å¾…æˆ‘å®¡æ‰¹</h2>
                    </div>
                    <div class="tabs">
                        <button class="tab-btn active" onclick="switchApprovalTab('leave')">
                            è¯·å‡å®¡æ‰¹
                            <span class="tab-badge" id="leave-tab-badge" style="display: none;">0</span>
                        </button>
                        <button class="tab-btn" onclick="switchApprovalTab('overtime')">
                            åŠ ç­å®¡æ‰¹
                            <span class="tab-badge" id="overtime-tab-badge" style="display: none;">0</span>
                        </button>
                    </div>
                    <div id="approval-leave-list" class="list-container"></div>
                    <div id="approval-overtime-list" class="list-container" style="display:none;"></div>
                </div>

                <!-- æˆ‘çš„ç»Ÿè®¡ -->
                <div id="stats-content" class="content-section">
                    <div class="section-header">
                        <button class="back-btn" onclick="showSection('home')">â† è¿”å›</button>
                        <h2>æˆ‘çš„ç»Ÿè®¡</h2>
                    </div>
                    <div class="date-filter">
                        <input type="month" id="stats-month" onchange="loadMyStats()">
                    </div>
                    <div id="stats-cards" class="stats-grid"></div>
                </div>
            </main>

            <!-- åº•éƒ¨å¯¼èˆª -->
            <nav class="bottom-nav">
                <a href="#" class="nav-item active" onclick="showSection('home')">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-label">é¦–é¡µ</span>
                </a>
                <a href="#" class="nav-item" onclick="showSection('attendance')">
                    <span class="nav-icon">ğŸ“</span>
                    <span class="nav-label">è€ƒå‹¤</span>
                </a>
                <a href="#" class="nav-item approval-only" onclick="showSection('approval')" style="display: none;">
                    <span class="nav-icon">âœ…</span>
                    <span class="nav-label">å®¡æ‰¹</span>
                </a>
                <a href="#" class="nav-item" onclick="showSection('stats')">
                    <span class="nav-icon">ğŸ“Š</span>
                    <span class="nav-label">ç»Ÿè®¡</span>
                </a>
            </nav>
        </div>
        
        <!-- ç‰ˆæƒä¿¡æ¯ -->
        <footer class="app-footer">
            <p>&copy; 2025 æ²³å—æ–°ç›Ÿç§‘æ•™æœ‰é™å…¬å¸ All Rights Reserved</p>
        </footer>
    </div>

    <!-- æ¨¡æ€æ¡†å®¹å™¨ -->
    <div id="modal-container"></div>

    <script src="app.js"></script>
</body>
</html>


