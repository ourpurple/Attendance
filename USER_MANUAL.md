# 用户手册

考勤与请假管理系统用户操作指南。

## 目录

1. [系统简介](#系统简介)
2. [登录与账户管理](#登录与账户管理)
3. [考勤打卡](#考勤打卡)
4. [请假管理](#请假管理)
5. [加班管理](#加班管理)
6. [审批管理](#审批管理)
7. [统计分析](#统计分析)
8. [管理员功能](#管理员功能)
9. [常见问题](#常见问题)

---

## 系统简介

### 访问方式

- **移动端网页**：在手机浏览器中访问系统地址
- **微信小程序**：在微信中搜索并打开小程序

### 系统功能

- ✅ 考勤打卡（上班/下班，支持位置记录）
- ✅ 请假申请（多级审批流程）
- ✅ 加班申请（审批管理）
- ✅ 审批管理（部门主任/副总/总经理）
- ✅ 统计分析（出勤、请假、加班统计）
- ✅ 出勤情况查看（授权用户可查看全员出勤）

---

## 登录与账户管理

### 登录系统

1. 打开系统（移动端网页或微信小程序）
2. 输入**用户名**和**密码**
3. 点击"登录"按钮

### 修改密码

1. 登录后，点击右上角**头像**
2. 选择"**修改密码**"
3. 输入**旧密码**和**新密码**
4. 点击"确定"保存

**⚠️ 首次登录后请立即修改密码！**

### 退出登录

点击右上角头像 → 选择"退出登录"

---

## 考勤打卡

### 打卡基本规则

#### 工作日判断

系统会自动判断今天是否为工作日：

- **工作日**：
  - 周一至周五（正常工作日）
  - 调休工作日（周末但需要上班的日期，由管理员配置）

- **休息日**：
  - 周六、周日（周末）
  - 法定节假日（由管理员配置）
  - 公司节假日（由管理员配置）

**非工作日打卡限制：**
- 非工作日时，打卡按钮自动禁用
- 显示提示："今日休息，不需打卡"（如有节假日名称，会显示具体节假日名称）

#### 打卡时间范围

打卡必须在系统配置的时间范围内进行：

- **上班打卡时间范围**：由管理员在打卡策略中配置（默认：08:00 - 11:30）
- **下班打卡时间范围**：由管理员在打卡策略中配置（默认：17:00 - 20:00）

**不在打卡时间内的处理：**
- 工作日但不在打卡时间内时，按钮禁用
- 显示提示："工作日，尚未开始打卡"

### 上班打卡

#### 操作步骤

1. 打开系统首页
2. 确认"**上班打卡**"按钮可用（工作日且在打卡时间内）
3. 点击"**上班打卡**"按钮
4. 系统自动获取位置信息
5. 选择打卡状态（正常签到/市区办事/出差）
6. 打卡成功后，按钮变为灰色，显示打卡时间

#### 打卡前检查

系统在打卡前会进行以下检查：

**1. 工作日检查**
- 非工作日：提示"今天是休息日，无需打卡"并阻止打卡

**2. 重复打卡检查**
- 如果今天已经打过上班卡，提示"今天已经打过上班卡"并阻止打卡

**3. 请假状态检查**
- **全天请假**：提示"今天全天请假，无需打卡"并阻止打卡
- **上午请假**：
  - 可以在 14:10 前打卡（用于下午正常上班）
  - 14:10 后不允许打卡，提示"上午请假，签到时间已过（14:10后不可签到）"
  - 14:10 前打卡会提示："您今天上午请假，可以在14:10前签到。确定要继续打卡吗？"

**4. 打卡时间范围检查**
- 不在打卡时间范围内：提示"当前时间不在上班打卡时间范围内（XX:XX - XX:XX）"并阻止打卡
- 如果上午请假，允许在 14:10 前打卡（不受正常打卡时间范围限制）

**5. 迟到检查**
- 如果当前时间超过上班时间（考虑迟到阈值），会提示：
  - "当前时间 XX:XX，已超过上班时间 XX:XX，打卡后将记录为迟到。确定要继续打卡吗？"
- 用户可以选择继续打卡（记录为迟到）或取消

#### 打卡状态选择

上班打卡时可以选择打卡状态：

- **正常签到**：正常到公司打卡
- **市区办事**：在市区办事，不在公司打卡
- **出差**：出差在外地打卡

#### 打卡后处理

- 打卡成功后，按钮变为灰色并显示"已打卡"
- 系统自动记录：
  - 打卡时间
  - 打卡位置（经纬度和地址）
  - 打卡状态
  - 是否迟到
  - 上午/下午状态

### 下班打卡

#### 操作步骤

1. 打开系统首页
2. 确认"**下班打卡**"按钮可用（已上班打卡且未下班打卡）
3. 点击"**下班打卡**"按钮
4. 系统自动获取位置信息
5. 打卡成功后，按钮变为灰色，显示打卡时间

#### 打卡前检查

系统在打卡前会进行以下检查：

**1. 上班打卡检查**
- 如果今天没有打上班卡，提示"请先打上班卡"并阻止打卡

**2. 重复打卡检查**
- 如果今天已经打过下班卡，提示"今天已经打过下班卡"并阻止打卡

**3. 请假状态检查**
- **下午请假**：提示"下午请假，无需签退"并阻止打卡

**4. 工作日检查**
- 非工作日：提示"今天是休息日，无需打卡"并阻止打卡

**5. 打卡时间范围检查**
- 不在打卡时间范围内：提示"当前时间不在下班打卡时间范围内（XX:XX - XX:XX）"并阻止打卡

**6. 早退检查**
- 如果当前时间早于下班时间（考虑早退阈值），会提示：
  - "当前时间 XX:XX，早于下班时间 XX:XX，打卡后将记录为早退。确定要继续打卡吗？"
- 用户可以选择继续打卡（记录为早退）或取消

#### 打卡后处理

- 打卡成功后，按钮变为灰色并显示"已打卡"
- 系统自动记录：
  - 打卡时间
  - 打卡位置（经纬度和地址）
  - 是否早退
  - 工作时长（自动计算：下班时间 - 上班时间）

### 按钮可用性逻辑

#### 上班打卡按钮

**可用条件（同时满足）：**
- ✅ 今天是工作日
- ✅ 当前时间在上班打卡时间范围内（或上午请假且在14:10前）
- ✅ 今天未打过上班卡
- ✅ 今天不是全天请假

**禁用情况：**
- ❌ 非工作日
- ❌ 不在打卡时间范围内
- ❌ 已打过上班卡
- ❌ 全天请假

#### 下班打卡按钮

**可用条件（同时满足）：**
- ✅ 今天是工作日
- ✅ 当前时间在下班打卡时间范围内
- ✅ 今天已打过上班卡
- ✅ 今天未打过下班卡
- ✅ 今天不是下午请假

**禁用情况：**
- ❌ 非工作日
- ❌ 未打上班卡
- ❌ 不在打卡时间范围内
- ❌ 已打过下班卡
- ❌ 下午请假

### 打卡状态显示

首页打卡卡片会显示：

- **当前时间**：实时显示当前时间（时:分:秒）
- **当前日期**：显示今天的日期
- **打卡状态**：
  - 上班：显示"未打卡"或"已打卡 XX:XX"
  - 下班：显示"未打卡"或"已打卡 XX:XX"
- **位置信息**：
  - 工作日：显示当前位置或"待获取"
  - 非工作日：显示"今日休息，不需打卡"

### 查看打卡记录

**方式一：首页查看**

1. 在首页向下滑动，查看"**最近考勤**"区域
2. 显示最近几天的打卡记录

**方式二：考勤记录页面**

1. 点击底部导航"**考勤**"标签
2. 选择要查看的月份
3. 查看详细的考勤记录，包括：
   - 打卡时间
   - 打卡地点
   - 打卡状态（正常签到/市区办事/出差）
   - 是否迟到/早退
   - 工作时长
   - 上午/下午状态

### 特殊情况说明

#### 请假与打卡的关系

- **全天请假**：不允许打卡
- **上午请假**：
  - 可以在 14:10 前打卡（用于下午正常上班）
  - 14:10 后不允许打卡
- **下午请假**：不允许下班打卡

#### 迟到早退判断

- **迟到判断**：
  - 上班打卡时间 > 上班时间 + 迟到阈值（由管理员在打卡策略中配置）
  - 如果上午请假，不判断迟到

- **早退判断**：
  - 下班打卡时间 < 下班时间 - 早退阈值（由管理员在打卡策略中配置）

#### 工作时长计算

- 系统自动计算：下班打卡时间 - 上班打卡时间
- 单位：小时（保留2位小数）

#### 位置获取

- 打卡时会自动获取当前位置（GPS）
- 需要允许浏览器/小程序获取位置权限
- 如果获取位置失败，会提示错误信息
- 位置信息包括：经纬度坐标和地址文本

---

## 请假管理

### 提交请假申请

**操作步骤：**

1. 在首页点击"**请假申请**"图标，或点击底部导航进入
2. 点击"**申请请假**"按钮
3. 填写请假信息：
   - **开始日期**：选择请假开始日期
   - **结束日期**：选择请假结束日期
   - **请假天数**：系统自动计算，支持半天（如：0.5、1.5、2.5）
   - **请假类型**：选择请假类型（如：年假调休、事假、病假等）
   - **请假原因**：填写请假原因（必填）
4. 点击"**提交**"按钮

**请假天数计算规则：**

- 系统根据开始日期和结束日期自动计算天数
- 支持半天请假（0.5天）
- 可以手动调整天数

**审批流程：**

根据请假天数，系统自动确定审批流程：

| 请假天数 | 审批流程 |
|---------|---------|
| **≤ 1天** | 部门主任审批 → 完成 |
| **1-3天（含3天）** | 部门主任审批 → 副总审批 → 完成 |
| **> 3天** | 部门主任审批 → 副总审批 → 总经理审批 → 完成 |

**特殊角色审批规则：**

- **副总请假**：
  - 3天以内（含3天）：副总审批（默认本人，可指定其他副总）→ 完成
  - 3天以上：副总审批（默认本人，可指定其他副总）→ 总经理审批 → 完成

- **总经理请假**：
  - 总经理本人直接审批 → 完成

### 查看请假记录

1. 在"请假管理"页面查看所有请假记录
2. 每条记录显示：
   - 请假日期范围
   - 请假天数
   - 请假类型
   - 请假原因
   - **审批状态**
   - **待审批人**（如有）

**审批状态说明：**

- **待审批**：申请已提交，等待审批
- **已批准**：所有审批人已批准，请假生效
- **已拒绝**：审批被拒绝，请假无效
- **已撤回**：您主动撤回了申请

### 查看请假详情

点击请假记录，可以查看：
- 完整的请假信息
- 审批进度
- 各审批人的审批意见和时间

### 撤回请假申请

**操作步骤：**

1. 在请假列表中，找到状态为"**待审批**"的记录
2. 点击"**撤回申请**"按钮
3. 确认撤回

**注意：** 只有"待审批"状态的申请可以撤回，已批准或已拒绝的无法撤回。

### 年假管理

系统支持年假管理功能：

- 每个用户有**年假天数**（默认10天）
- 系统自动统计年假使用情况
- 在"我的统计"中可以查看：
  - 总年假天数
  - 已使用年假天数
  - 剩余年假天数

---

## 加班管理

### 提交加班申请

**操作步骤：**

1. 在首页点击"**加班申请**"图标，或点击底部导航进入
2. 点击"**申请加班**"按钮
3. 填写加班信息：
   - **开始时间**：选择加班开始时间
   - **结束时间**：选择加班结束时间
   - **加班天数**：系统自动计算
     - 半天 = 0.5 天
     - 整天 = 1 天
     - 自定义 = x.5 天（如：1.5、2.5）
   - **加班类型**：选择主动加班或被动加班
   - **加班原因**：填写加班原因（必填）
4. 点击"**提交**"按钮

**加班天数计算规则：**

- 系统根据开始时间和结束时间自动计算
- 加班天数只能是整数或 x.5（如：1, 1.5, 2, 2.5）
- 可以手动调整天数

**审批流程：**

- **员工/部门主任加班**：部门主任审批 → 完成
- **副总加班**：副总审批（默认本人，可指定其他副总）→ 完成
- **总经理加班**：总经理本人审批 → 完成

### 查看加班记录

1. 在"加班管理"页面查看所有加班记录
2. 每条记录显示：
   - 加班时间范围
   - 加班天数
   - 加班类型
   - 加班原因
   - **审批状态**
   - **审批人**（如有）

### 撤回加班申请

操作方式与撤回请假申请相同，只能撤回"待审批"状态的申请。

---

## 审批管理

### 审批功能入口

**有审批权限的角色：**

- 部门主任
- 副总
- 总经理

**进入审批页面：**

1. 登录系统后，在首页可以看到"**我的审批**"图标
2. 如有待审批事项，会显示红色数字徽章
3. 点击"**我的审批**"图标，进入审批页面

### 审批请假申请

**操作步骤：**

1. 进入"我的审批"页面，默认显示"**请假审批**"标签页
2. 查看待审批的请假申请列表
3. 点击要审批的申请，查看详情
4. 点击"**批准**"或"**拒绝**"按钮
   - **批准**：可输入批准意见（可选）
   - **拒绝**：必须输入拒绝理由（必填）

**审批权限：**

- **部门主任**：
  - 只能审批本部门员工的请假申请
  - 只能审批状态为"待审批"的申请

- **副总**：
  - 可以审批分配给自己的请假申请
  - 可以审批分管部门的员工申请
  - 只能审批状态为"部门主任已批准"的申请

- **总经理**：
  - 可以审批分配给自己的请假申请
  - 可以审批所有需要总经理审批的申请（请假天数 > 3天）
  - 只能审批状态为"副总已批准"的申请

### 审批加班申请

操作方式与审批请假相同，在"**加班审批**"标签页中操作。

**审批权限：**

- **部门主任**：只能审批本部门员工的加班申请
- **副总**：可以审批分配给自己的加班申请
- **总经理**：可以审批所有加班申请

---

## 统计分析

### 我的统计

**查看个人统计数据：**

1. 在首页点击"**我的统计**"图标，或点击底部导航"**统计**"标签
2. 选择要查看的月份
3. 查看统计数据：

**统计内容：**

- **出勤统计**：
  - 应出勤天数
  - 实际出勤天数
  - 迟到次数
  - 早退次数
  - 缺勤天数
  - 工作时长

- **请假统计**：
  - 请假天数
  - 请假次数
  - 请假类型分类统计

- **加班统计**：
  - 加班天数
  - 加班次数
  - 主动加班/被动加班分类统计

- **年假统计**（如有）：
  - 总年假天数
  - 已使用年假天数
  - 剩余年假天数

### 出勤情况查看

**权限说明：**

- 系统管理员
- 被授权的用户（管理员可设置）

**查看方式：**

1. 在首页点击"**出勤情况**"图标（如有权限）
2. 选择要查看的日期
3. 查看当日所有员工的出勤情况：
   - 是否已打卡
   - 打卡时间
   - 是否迟到/早退
   - 是否有请假
   - 是否有加班

---

## 管理员功能

系统管理员拥有最高管理权限，可以通过管理后台进行全面的系统管理。

### 登录管理后台

1. 在电脑浏览器中访问管理后台地址（如：`https://your-domain.com/admin`）
2. 输入管理员用户名和密码
3. 点击"登录"按钮

**默认管理员账号：**
- 用户名：`admin`
- 密码：`admin123`

**⚠️ 重要：首次登录后请立即修改密码！**

### 用户管理

**添加用户：**

1. 进入"用户管理"页面
2. 点击"添加用户"按钮
3. 填写用户信息：
   - 用户名（必填，唯一）
   - 真实姓名（必填）
   - 邮箱（可选）
   - 手机号（可选）
   - 角色（必填）
   - 部门（必填）
   - 初始密码（必填）
   - 年假天数（默认10天）

**编辑用户：**

1. 在用户列表中找到要编辑的用户
2. 点击"编辑"按钮
3. 修改用户信息、角色、部门、状态等
4. 可以重置密码

**删除用户：**

- 点击"删除"按钮
- **注意：** 如有考勤记录，系统会保护，无法删除

### 部门管理

**添加部门：**

1. 进入"部门管理"页面
2. 点击"添加部门"按钮
3. 填写部门信息：
   - 部门名称（必填，唯一）
   - 部门描述（可选）
   - 部门主任（可选）

**编辑部门：**

- 修改部门信息、部门主任

**删除部门：**

- 删除部门前需先转移部门员工

### 分管关系管理

**设置副总分管部门：**

1. 进入"分管关系管理"页面
2. 点击"添加分管关系"按钮
3. 选择副总和部门
4. 设置是否为默认分管

**说明：**

- 一个部门可以有多个副总分管
- 但只有一个默认分管
- 默认分管用于自动分配审批人

### 请假类型管理

**添加请假类型：**

1. 进入"请假类型管理"页面
2. 点击"添加请假类型"按钮
3. 填写类型信息：
   - 类型名称（必填，唯一）
   - 类型说明（可选）

**编辑/删除请假类型：**

- 可以修改或删除请假类型
- 删除前需确保没有使用该类型的请假申请

### 打卡策略管理

**添加打卡策略：**

1. 进入"策略管理"页面
2. 点击"添加策略"按钮
3. 配置策略信息：
   - 策略名称
   - 上班时间
   - 下班时间
   - 上班打卡开始/结束时间
   - 下班打卡开始/结束时间
   - 迟到阈值（分钟）
   - 早退阈值（分钟）
   - 每周特殊规则（可选）

**编辑/删除策略：**

- 可以修改或删除策略
- 删除前需确保有其他策略可用

### 节假日配置

**添加节假日：**

1. 进入"节假日配置"页面
2. 点击"添加节假日"按钮
3. 选择节假日类型：
   - **休息日（法定节假日）**：节假日期间禁用打卡
   - **调休工作日（周末上班）**：周末但需要上班的日期
   - **公司节假日（休息）**：公司自定义的休息日

**批量添加：**

- 支持按日期范围批量添加节假日

**说明：**

- 系统已预置2025年全年法定节假日数据
- 管理员可根据实际情况调整

### 出勤情况查看授权

**授权用户查看出勤情况：**

1. 进入"出勤情况查看授权"页面
2. 点击"添加授权"按钮
3. 选择要授权的用户

**说明：**

- 被授权的用户可以在移动端查看全部人员的出勤情况
- 系统管理员默认拥有此权限

### 统计分析

**查看统计数据：**

1. 进入"统计分析"页面
2. 选择统计方式（按月或自定义日期范围）
3. 选择部门（可选）
4. 点击"查询"按钮

**统计内容：**

- **总统计**：
  - 总员工数
  - 出勤率
  - 总请假天数
  - 总加班天数

- **出勤统计**：
  - 员工考勤数据（应出勤、实际出勤、迟到、早退、缺勤、工时）

- **请假统计**：
  - 请假天数、次数
  - 请假类型分类统计

- **加班统计**：
  - 加班天数、次数
  - 主动加班/被动加班分类统计

---

## 常见问题

### 登录相关

**Q1: 忘记密码怎么办？**  
A: 请联系系统管理员重置密码。

**Q2: 如何修改密码？**  
A: 登录后，点击右上角头像 → 选择"修改密码"。

### 打卡相关

**Q3: 打卡时提示"无法获取位置"？**  
A: 
- 检查浏览器/小程序的定位权限
- 确保手机GPS已开启
- 尝试在室外或信号较好的地方打卡

**Q4: 为什么周末无法打卡？**  
A: 系统自动识别周末和法定节假日。如果周末需要上班（调休工作日），系统管理员会提前配置。

**Q5: 打卡后按钮还是可以点击？**  
A: 打卡成功后，页面会自动刷新。如果按钮仍然可点击，请手动刷新页面或检查网络连接。

**Q6: 如何查看历史考勤记录？**  
A: 在首页点击"考勤记录"标签，选择要查看的月份。

### 请假相关

**Q7: 请假申请提交后可以修改吗？**  
A: 不可以直接修改。如果申请还在"待审批"状态，可以撤回申请后重新提交。

**Q8: 请假天数如何计算？**  
A: 系统会根据开始日期和结束日期自动计算，支持半天请假（如：0.5天、1.5天），可以手动调整天数。

**Q9: 如何查看审批进度？**  
A: 在请假列表中，点击申请记录可以查看详情，包括当前审批状态、待审批人、已审批人的意见和时间。

**Q10: 年假如何查看？**  
A: 在"我的统计"页面可以查看年假使用情况（总天数、已使用、剩余天数）。

### 审批相关

**Q11: 为什么看不到"我的审批"功能？**  
A: "我的审批"功能只对部门主任、副总、总经理开放。普通员工没有审批权限。

**Q12: 审批时可以不填写意见吗？**  
A: 批准可以不填写意见（可选），拒绝必须填写拒绝理由（必填）。

**Q13: 副总如何指定审批人？**  
A: 副总在提交请假/加班申请时，可以手动指定其他副总作为审批人。

### 统计相关

**Q14: 统计数据不准确？**  
A: 统计数据基于考勤记录、请假申请、加班申请计算。如有疑问，请联系系统管理员。

**Q15: 如何查看其他人的出勤情况？**  
A: 只有被授权的用户（如系统管理员）可以查看全部人员的出勤情况。

---

## 审批流程总结

### 请假审批流程

```
员工/部门主任请假：
├─ ≤ 1天 → 部门主任审批 → 完成
├─ 1-3天（含3天） → 部门主任审批 → 副总审批 → 完成
└─ > 3天 → 部门主任审批 → 副总审批 → 总经理审批 → 完成

副总请假：
├─ ≤ 3天（含3天） → 副总审批（默认本人，可指定其他副总）→ 完成
└─ > 3天 → 副总审批（默认本人，可指定其他副总）→ 总经理审批 → 完成

总经理请假：
└─ 总经理本人审批 → 完成
```

### 加班审批流程

```
员工/部门主任加班：
└─ 部门主任审批 → 完成

副总加班：
└─ 副总审批（默认本人，可指定其他副总）→ 完成

总经理加班：
└─ 总经理本人审批 → 完成
```

---

**最后更新**: 2025-01-16  
**版本**: 1.0.0

如有疑问，请联系系统管理员。
